
<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Title</title>
</head>
<body onload="initialRequest()">
<canvas id = "pic"> </canvas>
<div id="content"></div>
<!--<div>Первое слово на изображении подходит к нему  <button id="result1" onclick="changeText(this.id)">Да</button></div>
<div>Второе слово на изображении подходит к нему  <button id="result2" onclick="changeText(this.id)">Да</button></div>
<div>Третье слово на изображении подходит к нему  <button id="result3" onclick="changeText(this.id)">Да</button></div>
<div>Первое слово на изображении подходит ко второму  <button id="result4" onclick="changeText(this.id)">Да</button></div>
<div>Первое слово на изображении подходит к третьему  <button id="result5" onclick="changeText(this.id)">Да</button></div>
<div>Второе слово на изображении подходит к третьему  <button id="result6" onclick="changeText(this.id)">Да</button></div> -->
<button id="send" onclick="initialRequest()">ЭТА КНОПКА КРАСНАЯ И НА НЕЙ НАПИСАНО "ИСЧО"</button>
<script>
    /*function requestKek()
    {
        let form = "";
        if (document.getElementById(result1).textContent === "Да") form += '1 ';
        else form += '0 ';
        if (document.getElementById(result2).textContent === "Да") form += '1 ';
        else form += '0 ';
        if (document.getElementById(result3).textContent === "Да") form += '1   ';
        else form += '0 ';
        if (document.getElementById(result4).textContent === "Да") form += '1 ';
        else form += '0 ';
        if (document.getElementById(result5).textContent === "Да") form += '1 ';
        else form += '0 ';
        if (document.getElementById(result6).textContent === "Да") form += '1';
        else form += '0';
        let url = new URL('http://localhost:8080/g1');
        url.searchParams.set('form', form);
        let xhr = new XMLHttpRequest();
        xhr.open("GET", url, [true]);
        xhr.send();
        xhr.onload = function() {
            if (xhr.status != 200) {
                alert(`Ошибка ${xhr.status}: ${xhr.statusText}`);
            }
            else {
                var canvas = document.getElementById('pic');

                if (canvas.getContext){
                    painter(xhr.response);
                } else {
                    alert("Ваш браузер не поддерживает кеки...");
                }
            }
        };
    }
    function changeText(id)
    {
        if ( document.getElementById(id).textContent == "Да") document.getElementById(id).textContent = "Нет"
        else document.getElementById(id).textContent = "Да"
    } */
    function downscale(image){
        var canvas = document.getElementById("pic");
        var ctx = canvas.getContext("2d");
        var img = new Image();

        img.onload = function () {

            // set size proportional to image
            canvas.height = canvas.width * (img.height / img.width);

            // step 1 - resize to 50%
            var oc = document.createElement('canvas'),
                octx = oc.getContext('2d');

            oc.width = img.width * 0.5;
            oc.height = img.height * 0.5;
            octx.drawImage(img, 0, 0, oc.width, oc.height);

            // step 2
            octx.drawImage(oc, 0, 0, oc.width * 0.5, oc.height * 0.5);

            // step 3, resize to final size
            ctx.drawImage(oc, 0, 0, oc.width * 0.5, oc.height * 0.5,
                0, 0, canvas.width, canvas.height);
        }
        img.src = "data:image/jpeg;base64,"+image;
    }

    function painter(data){
        const obj = JSON.parse(data);
        var canvas = document.getElementById("pic");
        var ctx = canvas.getContext("2d");
        const width  = window.innerWidth || document.documentElement.clientWidth ||
            document.body.clientWidth;
        const height = window.innerHeight|| document.documentElement.clientHeight||
            document.body.clientHeight;
        var image = new Image();
        image.onload = function() {
            canvas.width = obj.width;
            canvas.height = obj.height;
            ctx.drawImage(image, 0, 0);
        };
        image.src = "data:image/jpeg;base64,"+obj.image;
        //downscale(obj.image);
    }

    function initialRequest() {
        let url = new URL('http://localhost:8080/g1');
        let xhr = new XMLHttpRequest();
        xhr.open("GET", url, [true]);
        xhr.send();
        xhr.onload = function() {
            if (xhr.status != 200) {
                alert(`Ошибка ${xhr.status}: ${xhr.statusText}`);
            }
            else {
                painter(xhr.response);
            }
        };

    }
</script>
</body>
</html>